<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØºØ±Ù Ø§Ù„Ø¯Ø±Ø¯Ø´Ø© ÙˆØ§Ù„Ø£Ù„Ø¹Ø§Ø¨</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            color: white;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .room-section, .chat-section {
            background: rgba(255, 255, 255, 0.95);
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            backdrop-filter: blur(10px);
        }

        .room-controls {
            margin-bottom: 20px;
        }

        .input-group {
            margin-bottom: 15px;
        }

        .input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #555;
        }

        .input-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .input-group input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 10px rgba(102, 126, 234, 0.3);
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            transition: all 0.3s ease;
            margin: 5px;
        }

        .btn-primary {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: linear-gradient(45deg, #f093fb, #f5576c);
            color: white;
        }

        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(245, 87, 108, 0.4);
        }

        .room-info {
            background: linear-gradient(45deg, #a8edea, #fed6e3);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
        }

        .chat-messages {
            height: 300px;
            overflow-y: auto;
            border: 2px solid #eee;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            background: #f9f9f9;
        }

        .message {
            margin-bottom: 10px;
            padding: 8px 12px;
            border-radius: 8px;
            background: white;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .message-user {
            font-weight: bold;
            color: #667eea;
        }

        .games-section {
            background: rgba(255, 255, 255, 0.95);
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            backdrop-filter: blur(10px);
            margin-top: 20px;
        }

        .game-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }

        .tic-tac-toe {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 5px;
            max-width: 300px;
            margin: 20px auto;
        }

        .tic-cell {
            width: 80px;
            height: 80px;
            border: 2px solid #667eea;
            background: white;
            font-size: 24px;
            font-weight: bold;
            color: #667eea;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .tic-cell:hover {
            background: #f0f4ff;
            transform: scale(1.05);
        }

        .quiz-section {
            background: linear-gradient(45deg, #ffecd2, #fcb69f);
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
        }

        .question {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
        }

        .answers {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .answer-btn {
            padding: 10px;
            border: 2px solid #ff7b7b;
            background: white;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .answer-btn:hover {
            background: #ff7b7b;
            color: white;
            transform: translateY(-2px);
        }

        .scores {
            background: linear-gradient(45deg, #d299c2, #fef9d7);
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
        }

        .hidden {
            display: none;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .tic-cell {
                width: 60px;
                height: 60px;
                font-size: 18px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ® ØºØ±Ù Ø§Ù„Ø¯Ø±Ø¯Ø´Ø© ÙˆØ§Ù„Ø£Ù„Ø¹Ø§Ø¨ Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ© ğŸ®</h1>
            <p>Ø£Ù†Ø´Ø¦ ØºØ±ÙØ© Ù…Ø¹ Ø£ØµØ¯Ù‚Ø§Ø¦Ùƒ ÙˆØªØ­Ø¯Ø«ÙˆØ§ ÙˆØ§Ù„Ø¹Ø¨ÙˆØ§ Ù…Ø¹Ù‹Ø§!</p>
        </div>

        <div class="main-content">
            <div class="room-section">
                <h3>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØºØ±Ù</h3>
                
                <div class="room-controls">
                    <div class="input-group">
                        <label>Ø§Ø³Ù…Ùƒ:</label>
                        <input type="text" id="username" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ">
                    </div>
                    
                    <div class="input-group">
                        <label>ÙƒÙˆØ¯ Ø§Ù„ØºØ±ÙØ© (Ù„Ù„Ø§Ù†Ø¶Ù…Ø§Ù…):</label>
                        <input type="text" id="roomCode" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙˆØ¯ Ø§Ù„ØºØ±ÙØ©">
                    </div>
                    
                    <button class="btn btn-primary" onclick="createRoom()">Ø¥Ù†Ø´Ø§Ø¡ ØºØ±ÙØ© Ø¬Ø¯ÙŠØ¯Ø©</button>
                    <button class="btn btn-secondary" onclick="joinRoom()">Ø§Ù„Ø§Ù†Ø¶Ù…Ø§Ù… Ù„Ù„ØºØ±ÙØ©</button>
                </div>

                <div id="roomInfo" class="room-info hidden">
                    <h4>Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØºØ±ÙØ©</h4>
                    <p>ÙƒÙˆØ¯ Ø§Ù„ØºØ±ÙØ©: <span id="currentRoomCode"></span></p>
                    <p>Ø¹Ø¯Ø¯ Ø§Ù„Ù…ØªØµÙ„ÙŠÙ†: <span id="connectedUsers">0</span></p>
                    <button class="btn btn-secondary" onclick="leaveRoom()">Ù…ØºØ§Ø¯Ø±Ø© Ø§Ù„ØºØ±ÙØ©</button>
                </div>
            </div>

            <div class="chat-section">
                <h3>ğŸ’¬ Ø§Ù„Ø¯Ø±Ø¯Ø´Ø©</h3>
                <div id="chatMessages" class="chat-messages"></div>
                <div class="input-group">
                    <input type="text" id="messageInput" placeholder="Ø£ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ Ù‡Ù†Ø§..." onkeypress="handleKeyPress(event)">
                    <button class="btn btn-primary" onclick="sendMessage()">Ø¥Ø±Ø³Ø§Ù„</button>
                </div>
            </div>
        </div>

        <div class="games-section">
            <h3>ğŸ¯ Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨</h3>
            
            <div class="game-buttons">
                <button class="btn btn-primary" onclick="showGame('ticTacToe')">Ù„Ø¹Ø¨Ø© XO</button>
                <button class="btn btn-primary" onclick="showGame('quiz')">Ø£Ø³Ø¦Ù„Ø© Ø°ÙƒÙŠØ©</button>
                <button class="btn btn-primary" onclick="showGame('mathQuiz')">Ø£Ø³Ø¦Ù„Ø© Ø±ÙŠØ§Ø¶ÙŠØ©</button>
                <button class="btn btn-primary" onclick="showGame('scienceQuiz')">Ø£Ø³Ø¦Ù„Ø© Ø¹Ù„Ù…ÙŠØ©</button>
            </div>

            <!-- Ù„Ø¹Ø¨Ø© XO -->
            <div id="ticTacToeGame" class="hidden">
                <h4>ğŸ® Ù„Ø¹Ø¨Ø© XO</h4>
                <p>Ø§Ù„Ø¯ÙˆØ± Ø§Ù„Ø­Ø§Ù„ÙŠ: <span id="currentPlayer">X</span></p>
                <div class="tic-tac-toe" id="ticTacToeBoard"></div>
                <button class="btn btn-secondary" onclick="resetTicTacToe()">Ø¥Ø¹Ø§Ø¯Ø© ØªØ´ØºÙŠÙ„</button>
            </div>

            <!-- Ù„Ø¹Ø¨Ø© Ø§Ù„Ø£Ø³Ø¦Ù„Ø© -->
            <div id="quizGame" class="hidden">
                <div class="quiz-section">
                    <h4>ğŸ§  Ø£Ø³Ø¦Ù„Ø© Ø°ÙƒÙŠØ©</h4>
                    <div id="quizTimer" style="font-size: 24px; font-weight: bold; color: #ff4757; text-align: center; margin-bottom: 15px;">5</div>
                    <div class="question" id="questionText"></div>
                    <div class="answers" id="answersContainer"></div>
                    <div id="questionResult" style="margin-top: 15px; padding: 10px; border-radius: 8px; font-weight: bold; text-align: center;"></div>
                    <button class="btn btn-secondary" onclick="nextQuestion()">Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„ØªØ§Ù„ÙŠ</button>
                </div>
            </div>

            <div class="scores">
                <h4>ğŸ“Š Ø§Ù„Ù†Ù‚Ø§Ø·</h4>
                <div id="scoresContainer">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†Ù‚Ø§Ø· Ø¨Ø¹Ø¯</div>
            </div>
        </div>
    </div>

    <script>
        // Ù…ØªØºÙŠØ±Ø§Øª Ø¹Ø§Ù…Ø©
        let currentRoom = null;
        let currentUser = null;
        let users = {};
        let scores = {};
        let currentGame = null;
        let ticTacToeBoard = Array(9).fill('');
        let currentTicTacToePlayer = 'X';
        let quizTimer = null;
        let questionAnswered = false;
        let firstAnswerer = null;

        // Ø£Ø³Ø¦Ù„Ø© Ù…ØªÙ†ÙˆØ¹Ø©
        const questions = {
            general: [
                {
                    question: "Ù…Ø§ Ù‡Ùˆ Ø£ÙƒØ¨Ø± ÙƒÙˆÙƒØ¨ ÙÙŠ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø´Ù…Ø³ÙŠØ©ØŸ",
                    answers: ["Ø§Ù„Ù…Ø´ØªØ±ÙŠ", "Ø²Ø­Ù„", "Ø§Ù„Ø£Ø±Ø¶", "Ø§Ù„Ù…Ø±ÙŠØ®"],
                    correct: 0
                },
                {
                    question: "ÙƒÙ… Ø¹Ø¯Ø¯ Ù‚Ø§Ø±Ø§Øª Ø§Ù„Ø¹Ø§Ù„Ù…ØŸ",
                    answers: ["5", "6", "7", "8"],
                    correct: 2
                },
                {
                    question: "Ù…Ø§ Ù‡ÙŠ Ø¹Ø§ØµÙ…Ø© ÙØ±Ù†Ø³Ø§ØŸ",
                    answers: ["Ù…Ø±Ø³ÙŠÙ„ÙŠØ§", "Ù„ÙŠÙˆÙ†", "Ø¨Ø§Ø±ÙŠØ³", "Ù†ÙŠØ³"],
                    correct: 2
                },
                {
                    question: "Ù…Ù† ÙƒØªØ¨ Ø±ÙˆØ§ÙŠØ© 'Ù…Ø¦Ø© Ø¹Ø§Ù… Ù…Ù† Ø§Ù„Ø¹Ø²Ù„Ø©'ØŸ",
                    answers: ["ØºØ§Ø±Ø³ÙŠØ§ Ù…Ø§Ø±ÙƒÙŠØ²", "Ø¨ÙˆØ±Ø®ÙŠØ³", "ÙØ§Ø±ØºØ§Ø³ ÙŠÙˆØ³Ø§", "Ø¥ÙŠØ²Ø§Ø¨ÙŠÙ„ Ø§Ù„Ù„ÙŠÙ†Ø¯ÙŠ"],
                    correct: 0
                }
            ],
            math: [
                {
                    question: "Ù…Ø§ Ù‡Ùˆ Ù†Ø§ØªØ¬ 15 Ã— 8ØŸ",
                    answers: ["110", "120", "130", "140"],
                    correct: 1
                },
                {
                    question: "Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ø¬Ø°Ø± Ø§Ù„ØªØ±Ø¨ÙŠØ¹ÙŠ Ù„Ù€ 144ØŸ",
                    answers: ["11", "12", "13", "14"],
                    correct: 1
                },
                {
                    question: "ÙƒÙ… ÙŠØ³Ø§ÙˆÙŠ 2Â³ØŸ",
                    answers: ["6", "8", "9", "12"],
                    correct: 1
                }
            ],
            science: [
                {
                    question: "Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ø±Ù…Ø² Ø§Ù„ÙƒÙŠÙ…ÙŠØ§Ø¦ÙŠ Ù„Ù„Ø°Ù‡Ø¨ØŸ",
                    answers: ["Go", "Gd", "Au", "Ag"],
                    correct: 2
                },
                {
                    question: "ÙƒÙ… Ø¹Ø¯Ø¯ Ø¹Ø¸Ø§Ù… Ø§Ù„Ø¥Ù†Ø³Ø§Ù† Ø§Ù„Ø¨Ø§Ù„ØºØŸ",
                    answers: ["206", "208", "210", "212"],
                    correct: 0
                },
                {
                    question: "Ù…Ø§ Ù‡Ùˆ Ø£Ø³Ø±Ø¹ Ø­ÙŠÙˆØ§Ù† ÙÙŠ Ø§Ù„Ø¹Ø§Ù„Ù…ØŸ",
                    answers: ["Ø§Ù„ÙÙ‡Ø¯", "Ø§Ù„Ù†Ù…Ø±", "Ø§Ù„Ø£Ø³Ø¯", "Ø§Ù„ØµÙ‚Ø± Ø§Ù„Ø´Ø§Ù‡ÙŠÙ†"],
                    correct: 3
                }
            ]
        };

        let currentQuestions = questions.general;
        let currentQuestionIndex = 0;

        // ÙˆØ¸Ø§Ø¦Ù Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØºØ±Ù
        function createRoom() {
            const username = document.getElementById('username').value.trim();
            if (!username) {
                alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù…Ùƒ Ø£ÙˆÙ„Ø§Ù‹');
                return;
            }

            const roomCode = Math.random().toString(36).substring(2, 8).toUpperCase();
            currentRoom = roomCode;
            currentUser = username;
            users[username] = { score: 0 };
            scores[username] = 0;

            document.getElementById('currentRoomCode').textContent = roomCode;
            document.getElementById('connectedUsers').textContent = '1';
            document.getElementById('roomInfo').classList.remove('hidden');

            addMessage('Ø§Ù„Ù†Ø¸Ø§Ù…', `ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØºØ±ÙØ© Ø¨Ù†Ø¬Ø§Ø­! Ø´Ø§Ø±Ùƒ Ø§Ù„ÙƒÙˆØ¯ ${roomCode} Ù…Ø¹ Ø£ØµØ¯Ù‚Ø§Ø¦Ùƒ`);
            updateScores();
        }

        function joinRoom() {
            const username = document.getElementById('username').value.trim();
            const roomCode = document.getElementById('roomCode').value.trim();
            
            if (!username || !roomCode) {
                alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù…Ùƒ ÙˆÙƒÙˆØ¯ Ø§Ù„ØºØ±ÙØ©');
                return;
            }

            currentRoom = roomCode;
            currentUser = username;
            users[username] = { score: 0 };
            scores[username] = 0;

            document.getElementById('currentRoomCode').textContent = roomCode;
            document.getElementById('connectedUsers').textContent = Object.keys(users).length;
            document.getElementById('roomInfo').classList.remove('hidden');

            addMessage('Ø§Ù„Ù†Ø¸Ø§Ù…', `${username} Ø§Ù†Ø¶Ù… Ø¥Ù„Ù‰ Ø§Ù„ØºØ±ÙØ©`);
            updateScores();
        }

        function leaveRoom() {
            if (currentUser && users[currentUser]) {
                delete users[currentUser];
                delete scores[currentUser];
            }
            
            currentRoom = null;
            currentUser = null;
            document.getElementById('roomInfo').classList.add('hidden');
            document.getElementById('chatMessages').innerHTML = '';
            updateScores();
        }

        // ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø¯Ø±Ø¯Ø´Ø©
        function addMessage(user, message) {
            const messagesContainer = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message';
            messageDiv.innerHTML = `<span class="message-user">${user}:</span> ${message}`;
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function sendMessage() {
            const messageInput = document.getElementById('messageInput');
            const message = messageInput.value.trim();
            
            if (!message || !currentUser) return;

            addMessage(currentUser, message);
            messageInput.value = '';
        }

        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }

        // ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨
        function showGame(gameType) {
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„
            const playerCount = Object.keys(users).length;
            if (playerCount < 2) {
                alert('ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ù‡Ù†Ø§Ùƒ Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø©!');
                addMessage('Ø§Ù„Ù†Ø¸Ø§Ù…', 'âš ï¸ ÙŠØ¬Ø¨ Ø§Ù†ØªØ¸Ø§Ø± Ù„Ø§Ø¹Ø¨ Ø¢Ø®Ø± Ù„Ù„Ø¹Ø¨');
                return;
            }

            // Ø¥Ø®ÙØ§Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨
            document.getElementById('ticTacToeGame').classList.add('hidden');
            document.getElementById('quizGame').classList.add('hidden');

            switch(gameType) {
                case 'ticTacToe':
                    document.getElementById('ticTacToeGame').classList.remove('hidden');
                    initTicTacToe();
                    break;
                case 'quiz':
                    currentQuestions = questions.general;
                    currentQuestionIndex = 0;
                    document.getElementById('quizGame').classList.remove('hidden');
                    startQuizGame();
                    break;
                case 'mathQuiz':
                    currentQuestions = questions.math;
                    currentQuestionIndex = 0;
                    document.getElementById('quizGame').classList.remove('hidden');
                    startQuizGame();
                    break;
                case 'scienceQuiz':
                    currentQuestions = questions.science;
                    currentQuestionIndex = 0;
                    document.getElementById('quizGame').classList.remove('hidden');
                    startQuizGame();
                    break;
            }
        }

        // Ù„Ø¹Ø¨Ø© XO
        function initTicTacToe() {
            const board = document.getElementById('ticTacToeBoard');
            board.innerHTML = '';
            ticTacToeBoard = Array(9).fill('');
            currentTicTacToePlayer = 'X';
            document.getElementById('currentPlayer').textContent = 'X';

            for (let i = 0; i < 9; i++) {
                const cell = document.createElement('button');
                cell.className = 'tic-cell';
                cell.onclick = () => makeMove(i);
                board.appendChild(cell);
            }
        }

        function makeMove(index) {
            if (ticTacToeBoard[index] || !currentUser) return;

            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ù„Ø§Ø¹Ø¨ÙŠÙ†
            const playerCount = Object.keys(users).length;
            if (playerCount < 2) {
                alert('ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ù‡Ù†Ø§Ùƒ Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ Ù„Ù„Ø¹Ø¨!');
                return;
            }

            ticTacToeBoard[index] = currentTicTacToePlayer;
            document.getElementById('ticTacToeBoard').children[index].textContent = currentTicTacToePlayer;

            if (checkWinner()) {
                addMessage('Ø§Ù„Ù†Ø¸Ø§Ù…', `ğŸ‰ ${currentUser} ÙØ§Ø² ÙÙŠ Ù„Ø¹Ø¨Ø© XO!`);
                scores[currentUser] = (scores[currentUser] || 0) + 10;
                updateScores();
                return;
            }

            if (ticTacToeBoard.every(cell => cell !== '')) {
                addMessage('Ø§Ù„Ù†Ø¸Ø§Ù…', 'ØªØ¹Ø§Ø¯Ù„ ÙÙŠ Ù„Ø¹Ø¨Ø© XO!');
                return;
            }

            currentTicTacToePlayer = currentTicTacToePlayer === 'X' ? 'O' : 'X';
            document.getElementById('currentPlayer').textContent = currentTicTacToePlayer;
        }

        function checkWinner() {
            const winPatterns = [
                [0, 1, 2], [3, 4, 5], [6, 7, 8],
                [0, 3, 6], [1, 4, 7], [2, 5, 8],
                [0, 4, 8], [2, 4, 6]
            ];

            return winPatterns.some(pattern => {
                const [a, b, c] = pattern;
                return ticTacToeBoard[a] && 
                       ticTacToeBoard[a] === ticTacToeBoard[b] && 
                       ticTacToeBoard[a] === ticTacToeBoard[c];
            });
        }

        function resetTicTacToe() {
            initTicTacToe();
        }

        // Ù„Ø¹Ø¨Ø© Ø§Ù„Ø£Ø³Ø¦Ù„Ø©
        function startQuizGame() {
            addMessage('Ø§Ù„Ù†Ø¸Ø§Ù…', 'ğŸ¯ Ø¨Ø¯Ø¡ Ù„Ø¹Ø¨Ø© Ø§Ù„Ø£Ø³Ø¦Ù„Ø©! Ù„Ø¯ÙŠÙƒÙ… 5 Ø«ÙˆØ§Ù†Ù Ù„Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø¹Ù„Ù‰ ÙƒÙ„ Ø³Ø¤Ø§Ù„');
            showQuestion();
        }

        function showQuestion() {
            if (currentQuestionIndex >= currentQuestions.length) {
                addMessage('Ø§Ù„Ù†Ø¸Ø§Ù…', 'Ø§Ù†ØªÙ‡Øª Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©!');
                return;
            }

            const question = currentQuestions[currentQuestionIndex];
            document.getElementById('questionText').textContent = question.question;
            document.getElementById('questionResult').innerHTML = '';
            document.getElementById('questionResult').style.display = 'none';
            
            // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø­Ø§Ù„Ø© Ø§Ù„Ø³Ø¤Ø§Ù„
            questionAnswered = false;
            firstAnswerer = null;
            
            const answersContainer = document.getElementById('answersContainer');
            answersContainer.innerHTML = '';

            question.answers.forEach((answer, index) => {
                const button = document.createElement('button');
                button.className = 'answer-btn';
                button.textContent = answer;
                button.onclick = () => checkAnswer(index, currentUser);
                button.disabled = false;
                answersContainer.appendChild(button);
            });

            // Ø¨Ø¯Ø¡ Ø§Ù„Ø¹Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ
            startQuizTimer();
        }

        function startQuizTimer() {
            let timeLeft = 5;
            const timerElement = document.getElementById('quizTimer');
            timerElement.textContent = timeLeft;
            timerElement.style.color = '#ff4757';

            quizTimer = setInterval(() => {
                timeLeft--;
                timerElement.textContent = timeLeft;
                
                if (timeLeft <= 0) {
                    clearInterval(quizTimer);
                    if (!questionAnswered) {
                        addMessage('Ø§Ù„Ù†Ø¸Ø§Ù…', 'â° Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆÙ‚Øª! Ù„Ù… ÙŠØ¬Ø¨ Ø£Ø­Ø¯ ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ø­Ø¯Ø¯');
                        disableAnswerButtons();
                        showQuestionResult('Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆÙ‚Øª!', '#ff4757');
                    }
                }
            }, 1000);
        }

        function checkAnswer(selectedIndex, answeringUser) {
            if (questionAnswered) return;

            const question = currentQuestions[currentQuestionIndex];
            const isCorrect = selectedIndex === question.correct;
            
            // Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…Ø¤Ù‚Øª
            clearInterval(quizTimer);
            
            if (isCorrect) {
                // Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø© - ÙŠØ­ØµÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù†Ù‚Ø·Ø©
                questionAnswered = true;
                scores[answeringUser] = (scores[answeringUser] || 0) + 1;
                addMessage('Ø§Ù„Ù†Ø¸Ø§Ù…', `âœ… ${answeringUser} Ø£Ø¬Ø§Ø¨ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­ Ø£ÙˆÙ„Ø§Ù‹! +1 Ù†Ù‚Ø·Ø©`);
                showQuestionResult(`${answeringUser} Ø£Ø¬Ø§Ø¨ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­!`, '#2ed573');
                disableAnswerButtons();
                updateScores();
            } else {
                // Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø®Ø§Ø·Ø¦Ø©
                if (!firstAnswerer) {
                    firstAnswerer = answeringUser;
                    addMessage('Ø§Ù„Ù†Ø¸Ø§Ù…', `âŒ ${answeringUser} Ø£Ø¬Ø§Ø¨ Ø®Ø·Ø£! ÙØ±ØµØ© Ù„Ù„Ø¢Ø®Ø±ÙŠÙ†`);
                    showQuestionResult(`${answeringUser} Ø£Ø¬Ø§Ø¨ Ø®Ø·Ø£ - ÙØ±ØµØ© Ù„Ù„Ø¢Ø®Ø±ÙŠÙ†`, '#ff6b6b');
                    
                    // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø²Ø± Ø§Ù„Ø°ÙŠ Ø§Ø®ØªØ§Ø±Ù‡ Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ø£ÙˆÙ„
                    const buttons = document.querySelectorAll('.answer-btn');
                    buttons[selectedIndex].disabled = true;
                    buttons[selectedIndex].style.opacity = '0.5';
                    
                    // Ø¥Ø¹Ø§Ø¯Ø© ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…Ø¤Ù‚Øª Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø§Ù„Ø¢Ø®Ø±ÙŠÙ†
                    startQuizTimer();
                } else {
                    // Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ø«Ø§Ù†ÙŠ Ø£Ø¬Ø§Ø¨ Ø®Ø·Ø£ Ø£ÙŠØ¶Ø§Ù‹
                    questionAnswered = true;
                    addMessage('Ø§Ù„Ù†Ø¸Ø§Ù…', `âŒ ${answeringUser} Ø£Ø¬Ø§Ø¨ Ø®Ø·Ø£ Ø£ÙŠØ¶Ø§Ù‹! Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©: ${question.answers[question.correct]}`);
                    showQuestionResult(`ÙƒÙ„Ø§ÙƒÙ…Ø§ Ø£Ø¬Ø§Ø¨ Ø®Ø·Ø£! Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©: ${question.answers[question.correct]}`, '#ff4757');
                    disableAnswerButtons();
                }
            }
        }

        function disableAnswerButtons() {
            const buttons = document.querySelectorAll('.answer-btn');
            buttons.forEach(button => {
                button.disabled = true;
                button.style.opacity = '0.7';
            });
        }

        function showQuestionResult(message, color) {
            const resultDiv = document.getElementById('questionResult');
            resultDiv.innerHTML = message;
            resultDiv.style.backgroundColor = color;
            resultDiv.style.color = 'white';
            resultDiv.style.display = 'block';
        }

        function nextQuestion() {
            // Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…Ø¤Ù‚Øª Ø¥Ø°Ø§ ÙƒØ§Ù† ÙŠØ¹Ù…Ù„
            if (quizTimer) {
                clearInterval(quizTimer);
            }
            
            currentQuestionIndex++;
            showQuestion();
        }

        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†Ù‚Ø§Ø·
        function updateScores() {
            const scoresContainer = document.getElementById('scoresContainer');
            if (Object.keys(scores).length === 0) {
                scoresContainer.innerHTML = 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†Ù‚Ø§Ø· Ø¨Ø¹Ø¯';
                return;
            }

            const sortedScores = Object.entries(scores).sort((a, b) => b[1] - a[1]);
            scoresContainer.innerHTML = sortedScores.map(([user, score], index) => 
                `<p>${index + 1}. ${user}: ${score} Ù†Ù‚Ø·Ø©</p>`
            ).join('');
        }

        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù„Ø¹Ø¨Ø©
        document.addEventListener('DOMContentLoaded', function() {
            addMessage('Ø§Ù„Ù†Ø¸Ø§Ù…', 'Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ! Ø£Ù†Ø´Ø¦ ØºØ±ÙØ© Ø¬Ø¯ÙŠØ¯Ø© Ø£Ùˆ Ø§Ù†Ø¶Ù… Ù„ØºØ±ÙØ© Ù…ÙˆØ¬ÙˆØ¯Ø© Ù„ØªØ¨Ø¯Ø£ Ø§Ù„Ù„Ø¹Ø¨');
        });
    </script>
</body>
</html>