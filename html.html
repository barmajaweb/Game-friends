<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>لعبة الأسئلة الذكية</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: white;
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .game-screen {
            width: 100%;
            display: none;
        }

        .game-screen.active {
            display: block;
        }

        .title {
            text-align: center;
            margin-bottom: 40px;
        }

        .title h1 {
            font-size: 3.5rem;
            margin-bottom: 20px;
            animation: pulse 2s infinite;
        }

        .title p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .categories-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .category-card, .difficulty-card, .count-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .category-card:hover, .difficulty-card:hover, .count-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            background: rgba(255, 255, 255, 0.15);
        }

        .category-icon, .difficulty-icon {
            font-size: 3rem;
            margin-bottom: 15px;
            display: block;
        }

        .category-card:hover .category-icon {
            animation: bounce 0.5s ease;
        }

        .category-title, .difficulty-title {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .category-stats {
            font-size: 0.9rem;
            opacity: 0.8;
            margin-bottom: 15px;
        }

        .difficulty-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .count-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .count-card {
            padding: 20px;
        }

        .count-number {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .count-max {
            background: linear-gradient(45deg, #f39c12, #e67e22);
            border: 2px solid #f1c40f;
        }

        .back-btn, .exit-btn {
            background: rgba(108, 117, 125, 0.3);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .back-btn:hover, .exit-btn:hover {
            background: rgba(108, 117, 125, 0.5);
        }

        .game-header {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .header-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .header-icons {
            font-size: 2rem;
        }

        .score-display {
            text-align: right;
        }

        .score-number {
            font-size: 1.5rem;
            font-weight: bold;
            color: #f1c40f;
        }

        .progress-bar {
            width: 100%;
            height: 12px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 6px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #3498db, #9b59b6);
            transition: width 0.5s ease;
            border-radius: 6px;
        }

        .question-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 40px;
            margin-bottom: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .question-text {
            font-size: 1.8rem;
            font-weight: bold;
            text-align: center;
            margin-bottom: 40px;
            line-height: 1.4;
        }

        .options-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }

        .option-btn {
            padding: 20px;
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            background: rgba(255, 255, 255, 0.2);
            color: white;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .option-btn:hover {
            transform: scale(1.02);
            background: rgba(255, 255, 255, 0.3);
        }

        .option-btn:disabled {
            cursor: not-allowed;
        }

        .option-correct {
            background: #27ae60 !important;
            border-color: #2ecc71 !important;
            animation: pulse 1s ease;
        }

        .option-wrong {
            background: #e74c3c !important;
            border-color: #c0392b !important;
        }

        .option-disabled {
            background: rgba(108, 117, 125, 0.5) !important;
            color: rgba(255, 255, 255, 0.6) !important;
        }

        .feedback {
            text-align: center;
            margin-top: 20px;
            font-size: 1.2rem;
            font-weight: bold;
        }

        .feedback.correct {
            color: #2ecc71;
        }

        .feedback.wrong {
            color: #e74c3c;
        }

        .result-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            text-align: center;
            max-width: 500px;
            margin: 0 auto;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .trophy {
            font-size: 5rem;
            margin-bottom: 20px;
            animation: bounce 2s infinite;
        }

        .final-score {
            font-size: 4rem;
            font-weight: bold;
            margin: 20px 0;
        }

        .final-score.excellent { color: #2ecc71; }
        .final-score.good { color: #f39c12; }
        .final-score.poor { color: #e74c3c; }

        .result-message {
            font-size: 1.3rem;
            margin-bottom: 30px;
            color: #f1c40f;
        }

        .result-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .stat-value {
            font-size: 1.8rem;
            font-weight: bold;
        }

        .stat-label {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .result-buttons {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .result-btn {
            padding: 15px 30px;
            border-radius: 10px;
            border: none;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-primary { background: #3498db; color: white; }
        .btn-secondary { background: #9b59b6; color: white; }
        .btn-warning { background: #f39c12; color: white; }
        .btn-dark { background: #95a5a6; color: white; }

        .result-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .info-box {
            background: rgba(52, 152, 219, 0.2);
            border: 1px solid rgba(52, 152, 219, 0.5);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 30px;
            text-align: center;
        }

        .levels-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .level-info {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .level-info h3 {
            margin-bottom: 10px;
            font-size: 1.2rem;
        }

        .level-info p {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        @keyframes bounce {
            0%, 20%, 53%, 80%, 100% { transform: translateY(0); }
            40%, 43% { transform: translateY(-10px); }
            70% { transform: translateY(-5px); }
        }

        @media (max-width: 768px) {
            .title h1 { font-size: 2.5rem; }
            .question-text { font-size: 1.4rem; }
            .options-grid { grid-template-columns: 1fr; }
            .header-top { flex-direction: column; gap: 15px; text-align: center; }
            .difficulty-grid { grid-template-columns: 1fr; }
            .count-grid { grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- شاشة اختيار المجال -->
        <div id="categoryScreen" class="game-screen active">
            <div class="title">
                <h1>🧠 لعبة الأسئلة الذكية</h1>
                <p>اختبر معلوماتك في مختلف المجالات مع 3 مستويات صعوبة</p>
            </div>
            
            <div class="levels-info">
                <div class="level-info" style="background: rgba(46, 204, 113, 0.2);">
                    <h3>سهل 🟢</h3>
                    <p>نقطة واحدة لكل إجابة صحيحة</p>
                </div>
                <div class="level-info" style="background: rgba(243, 156, 18, 0.2);">
                    <h3>متوسط 🟡</h3>
                    <p>نقطتان لكل إجابة صحيحة</p>
                </div>
                <div class="level-info" style="background: rgba(231, 76, 60, 0.2);">
                    <h3>صعب 🔴</h3>
                    <p>ثلاث نقاط لكل إجابة صحيحة</p>
                </div>
            </div>

            <div class="categories-grid" id="categoriesGrid">
                <!-- سيتم ملؤها بـ JavaScript -->
            </div>
        </div>

        <!-- شاشة اختيار الصعوبة -->
        <div id="difficultyScreen" class="game-screen">
            <div class="title">
                <div id="selectedCategoryIcon" style="font-size: 4rem; margin-bottom: 20px;"></div>
                <h1 id="selectedCategoryName"></h1>
                <p>اختر مستوى الصعوبة</p>
            </div>

            <div class="difficulty-grid" id="difficultyGrid">
                <!-- سيتم ملؤها بـ JavaScript -->
            </div>

            <div style="text-align: center;">
                <button class="back-btn" onclick="goBack()">العودة لاختيار المجال</button>
            </div>
        </div>

        <!-- شاشة اختيار عدد الأسئلة -->
        <div id="questionsScreen" class="game-screen">
            <div class="title">
                <div style="display: flex; justify-content: center; align-items: center; gap: 15px; margin-bottom: 20px;">
                    <span id="questionsCategoryIcon" style="font-size: 3rem;"></span>
                    <span id="questionsDifficultyIcon" style="font-size: 2.5rem;"></span>
                </div>
                <h1 id="questionsCategoryName"></h1>
                <p>مستوى <span id="questionsDifficultyName"></span></p>
                <p style="margin-top: 10px;">اختر عدد الأسئلة</p>
            </div>

            <div class="info-box">
                <p><strong id="maxQuestionsAvailable"></strong> سؤال متوفر في هذا المستوى</p>
                <p style="margin-top: 5px;"><span id="pointsPerQuestion"></span> لكل إجابة صحيحة</p>
            </div>

            <div class="count-grid" id="countGrid">
                <!-- سيتم ملؤها بـ JavaScript -->
            </div>

            <div style="text-align: center;">
                <button class="back-btn" onclick="goBack()">العودة لاختيار الصعوبة</button>
            </div>
        </div>

        <!-- شاشة اللعب -->
        <div id="gameScreen" class="game-screen">
            <div class="game-header">
                <div class="header-top">
                    <div class="header-info">
                        <span id="gameCategoryIcon" class="header-icons"></span>
                        <div>
                            <h2 id="gameCategoryName" style="margin-bottom: 5px;"></h2>
                            <p id="gameProgress"></p>
                        </div>
                    </div>
                    <div class="score-display">
                        <div class="score-number" id="currentScore">0</div>
                        <p style="font-size: 0.9rem; opacity: 0.8;">النقاط</p>
                    </div>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width: 0%;"></div>
                </div>
            </div>

            <div class="question-card">
                <div class="question-text" id="questionText"></div>
                <div class="options-grid" id="optionsGrid">
                    <!-- سيتم ملؤها بـ JavaScript -->
                </div>
                <div class="feedback" id="feedback"></div>
            </div>

            <div style="text-align: center;">
                <button class="exit-btn" onclick="resetGame()">الخروج من اللعبة</button>
            </div>
        </div>

        <!-- شاشة النتائج -->
        <div id="resultScreen" class="game-screen">
            <div class="result-card">
                <div class="trophy">🏆</div>
                <h2 style="font-size: 2rem; margin-bottom: 20px;">انتهت اللعبة!</h2>
                
                <div style="display: flex; justify-content: center; align-items: center; gap: 10px; margin-bottom: 20px;">
                    <span id="resultCategoryIcon" style="font-size: 2rem;"></span>
                    <span id="resultCategoryName" style="font-size: 1.2rem;"></span>
                </div>
                
                <div style="display: flex; justify-content: center; align-items: center; gap: 10px; margin-bottom: 30px;">
                    <span id="resultDifficultyIcon" style="font-size: 1.5rem;"></span>
                    <span id="resultDifficultyName" style="font-size: 1rem; opacity: 0.8;"></span>
                </div>

                <div class="final-score" id="finalScore"></div>
                <div style="font-size: 1.3rem; margin-bottom: 10px;">النسبة: <span id="percentage"></span>%</div>
                <div class="result-message" id="resultMessage"></div>

                <div class="result-stats">
                    <div class="stat-item">
                        <div class="stat-value" id="totalQuestions"></div>
                        <div class="stat-label">الأسئلة المجابة</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="correctAnswers" style="color: #2ecc71;"></div>
                        <div class="stat-label">الإجابات الصحيحة</div>
                    </div>
                </div>

                <div class="result-buttons">
                    <button class="result-btn btn-primary" onclick="playAgain()">
                        🔄 نفس الإعدادات مرة أخرى
                    </button>
                    <button class="result-btn btn-secondary" onclick="changeQuestionCount()">
                        تغيير عدد الأسئلة
                    </button>
                    <button class="result-btn btn-warning" onclick="changeDifficulty()">
                        تغيير مستوى الصعوبة
                    </button>
                    <button class="result-btn btn-dark" onclick="resetGame()">
                        العودة للقائمة الرئيسية
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // بيانات اللعبة
        const gameData = {
            difficulties: {
                easy: { name: 'سهل', icon: '🟢', multiplier: 1, color: '#27ae60' },
                medium: { name: 'متوسط', icon: '🟡', multiplier: 2, color: '#f39c12' },
                hard: { name: 'صعب', icon: '🔴', multiplier: 3, color: '#e74c3c' }
            },
            categories: {
                sports: {
                    name: 'الرياضة',
                    icon: '⚽',
                    color: '#27ae60',
                    questions: {
                        easy: [
                            { question: 'كم عدد اللاعبين في فريق كرة القدم؟', options: ['10', '11', '12', '9'], correct: '11' },
                            { question: 'في أي رياضة يستخدم مضرب وكرة صفراء؟', options: ['كرة الطاولة', 'التنس', 'الاسكواش', 'البادل'], correct: 'التنس' },
                            { question: 'كم عدد اللاعبين في فريق الكرة الطائرة؟', options: ['5', '6', '7', '8'], correct: '6' },
                            { question: 'كم عدد الحلقات في شعار الألعاب الأولمبية؟', options: ['4', '5', '6', '7'], correct: '5' },
                            { question: 'ما هو أقصر مسافة في سباقات الجري؟', options: ['50 متر', '100 متر', '200 متر', '400 متر'], correct: '100 متر' },
                            { question: 'في أي لعبة يستخدم الشبكة والكرة؟', options: ['كرة السلة', 'كرة الطائرة', 'كرة اليد', 'الهوكي'], correct: 'كرة الطائرة' },
                            { question: 'كم عدد اللاعبين في فريق كرة السلة على الملعب؟', options: ['4', '5', '6', '7'], correct: '5' },
                            { question: 'ما اسم الرياضة التي تُلعب بالمضارب والريشة؟', options: ['التنس', 'تنس الطاولة', 'الريشة الطائرة', 'الاسكواش'], correct: 'الريشة الطائرة' },
                            { question: 'في أي رياضة يتم استخدام المرمى؟', options: ['كرة السلة', 'كرة القدم', 'الكرة الطائرة', 'التنس'], correct: 'كرة القدم' },
                            { question: 'كم دقيقة في شوط كرة القدم الواحد؟', options: ['40', '45', '50', '60'], correct: '45' }
                        ],
                        medium: [
                            { question: 'في أي عام أقيمت أول بطولة كأس العالم؟', options: ['1928', '1930', '1932', '1934'], correct: '1930' },
                            { question: 'ما هي المدة الزمنية لمباراة كرة السلة في الدوري الأمريكي؟', options: ['40 دقيقة', '45 دقيقة', '48 دقيقة', '50 دقيقة'], correct: '48 دقيقة' },
                            { question: 'أين أقيمت أولمبياد 2020؟', options: ['طوكيو', 'لندن', 'ريو', 'بكين'], correct: 'طوكيو' },
                            { question: 'ما هو أطول سباق في ألعاب القوى؟', options: ['5000 متر', '10000 متر', 'الماراثون', 'نصف الماراثون'], correct: 'الماراثون' },
                            { question: 'كم عدد الأشواط في مباراة التنس؟', options: ['3', '4', '5', '6'], correct: '3' },
                            { question: 'من فاز بكأس العالم 2018؟', options: ['البرازيل', 'ألمانيا', 'فرنسا', 'الأرجنتين'], correct: 'فرنسا' },
                            { question: 'كم يبلغ طول مضمار الجري الأولمبي؟', options: ['200 متر', '300 متر', '400 متر', '500 متر'], correct: '400 متر' },
                            { question: 'في أي رياضة يُمنح "السلام الكبير"؟', options: ['التنس', 'الجولف', 'الفورمولا 1', 'كرة السلة'], correct: 'التنس' },
                            { question: 'كم عدد اللاعبين في فريق الرجبي؟', options: ['13', '15', '17', '19'], correct: '15' },
                            { question: 'ما هو اسم بطولة التنس الشهيرة في إنجلترا؟', options: ['ويمبلدون', 'أوبن أستراليا', 'أوبن فرنسا', 'أوبن أمريكا'], correct: 'ويمبلدون' }
                        ],
                        hard: [
                            { question: 'من هو أكثر لاعب تسجيلاً للأهداف في تاريخ كأس العالم؟', options: ['بيليه', 'مارادونا', 'ميروسلاف كلوزه', 'رونالدو البرازيلي'], correct: 'ميروسلاف كلوزه' },
                            { question: 'في أي عام فازت مصر بكأس الأمم الأفريقية لأول مرة؟', options: ['1957', '1959', '1962', '1965'], correct: '1957' },
                            { question: 'ما هو الرقم القياسي العالمي لسباق 100 متر للرجال؟', options: ['9.58 ثانية', '9.63 ثانية', '9.69 ثانية', '9.72 ثانية'], correct: '9.58 ثانية' },
                            { question: 'من هو أول عربي فاز بميدالية ذهبية أولمبية؟', options: ['محمد علي كلاي', 'نوال المتوكل', 'طه حسين', 'هشام الكروج'], correct: 'نوال المتوكل' },
                            { question: 'كم عدد المرات التي فازت بها البرازيل بكأس العالم؟', options: ['4', '5', '6', '7'], correct: '5' },
                            { question: 'في أي عام تأسس الاتحاد الدولي لكرة القدم (فيفا)؟', options: ['1902', '1904', '1906', '1908'], correct: '1904' },
                            { question: 'ما هو أسرع رقم قياسي في سباق الماراثون؟', options: ['2:01:09', '2:01:39', '2:02:57', '2:03:38'], correct: '2:01:09' },
                            { question: 'من هو أول لاعب عربي لعب في الدوري الإنجليزي الممتاز؟', options: ['محمد صلاح', 'رياض محرز', 'علي داعي', 'طلال السلمان'], correct: 'علي داعي' }
                        ]
                    }
                },
                history: {
                    name: 'التاريخ',
                    icon: '🏛️',
                    color: '#f39c12',
                    questions: {
                        easy: [
                            { question: 'من هو أول خليفة راشدي؟', options: ['عمر بن الخطاب', 'أبو بكر الصديق', 'عثمان بن عفان', 'علي بن أبي طالب'], correct: 'أبو بكر الصديق' },
                            { question: 'من بنى الأهرامات؟', options: ['الآشوريون', 'البابليون', 'الفراعنة', 'الرومان'], correct: 'الفراعنة' },
                            { question: 'في أي قارة نشأت الحضارة الفرعونية؟', options: ['آسيا', 'أفريقيا', 'أوروبا', 'أمريكا'], correct: 'أفريقيا' },
                            { question: 'ما هو اسم النهر الذي قامت عليه الحضارة المصرية القديمة؟', options: ['الفرات', 'النيل', 'دجلة', 'الأردن'], correct: 'النيل' },
                            { question: 'من هو النبي الذي بُني له المسجد الأقصى؟', options: ['إبراهيم', 'موسى', 'عيسى', 'محمد'], correct: 'إبراهيم' },
                            { question: 'في أي عصر عاش الرسول محمد صلى الله عليه وسلم؟', options: ['القرن الخامس', 'القرن السادس', 'القرن السابع', 'القرن الثامن'], correct: 'القرن السادس' },
                            { question: 'ما هي أول دولة إسلامية؟', options: ['الدولة الأموية', 'الدولة العباسية', 'دولة المدينة', 'الدولة الفاطمية'], correct: 'دولة المدينة' },
                            { question: 'من هو فاتح مصر؟', options: ['خالد بن الوليد', 'عمرو بن العاص', 'طارق بن زياد', 'سعد بن أبي وقاص'], correct: 'عمرو بن العاص' }
                        ],
                        medium: [
                            { question: 'متى سقطت الدولة العثمانية؟', options: ['1918', '1920', '1922', '1924'], correct: '1922' },
                            { question: 'في أي عام فتحت القسطنطينية؟', options: ['1453', '1451', '1455', '1457'], correct: '1453' },
                            { question: 'من هو قائد الفتح الإسلامي للأندلس؟', options: ['طارق بن زياد', 'موسى بن نصير', 'عقبة بن نافع', 'عمرو بن العاص'], correct: 'طارق بن زياد' },
                            { question: 'في أي قرن عاش ابن خلدون؟', options: ['القرن 12', 'القرن 13', 'القرن 14', 'القرن 15'], correct: 'القرن 14' },
                            { question: 'متى انتهت الحرب العالمية الثانية؟', options: ['1944', '1945', '1946', '1947'], correct: '1945' },
                            { question: 'في أي عام وقعت معركة حطين؟', options: ['1185', '1187', '1189', '1191'], correct: '1187' }
                        ],
                        hard: [
                            { question: 'في أي عام وقعت معركة ذات السلاسل؟', options: ['12 هـ', '13 هـ', '14 هـ', '15 هـ'], correct: '12 هـ' },
                            { question: 'من هو مؤسس الدولة الأيوبية؟', options: ['صلاح الدين الأيوبي', 'نور الدين زنكي', 'الملك العادل', 'الأفضل'], correct: 'صلاح الدين الأيوبي' },
                            { question: 'كم سنة دامت الخلافة الراشدة؟', options: ['28 سنة', '29 سنة', '30 سنة', '31 سنة'], correct: '30 سنة' },
                            { question: 'في أي عام وقعت معركة بلاط الشهداء؟', options: ['114 هـ', '115 هـ', '116 هـ', '117 هـ'], correct: '114 هـ' },
                            { question: 'من هو مؤسس الدولة الفاطمية؟', options: ['المهدي بالله', 'القائم بأمر الله', 'المنصور بالله', 'المعز لدين الله'], correct: 'المهدي بالله' }
                        ]
                    }
                },
                geography: {
                    name: 'الجغرافيا',
                    icon: '🌍',
                    color: '#3498db',
                    questions: {
                        easy: [
                            { question: 'ما هي أكبر قارة في العالم؟', options: ['أفريقيا', 'آسيا', 'أوروبا', 'أمريكا الشمالية'], correct: 'آسيا' },
                            { question: 'كم عدد المحيطات في العالم؟', options: ['3', '4', '5', '6'], correct: '5' },
                            { question: 'ما هي عاصمة اليابان؟', options: ['أوساكا', 'كيوتو', 'طوكيو', 'يوكوهاما'], correct: 'طوكيو' },
                            { question: 'في أي قارة تقع مصر؟', options: ['آسيا', 'أفريقيا', 'أوروبا', 'أستراليا'], correct: 'أفريقيا' },
                            { question: 'ما هي عاصمة فرنسا؟', options: ['مارسيليا', 'ليون', 'باريس', 'نيس'], correct: 'باريس' },
                            { question: 'أي قارة تقع فيها البرازيل؟', options: ['أمريكا الشمالية', 'أمريكا الجنوبية', 'أفريقيا', 'آسيا'], correct: 'أمريكا الجنوبية' }
                        ],
                        medium: [
                            { question: 'أي نهر يعتبر الأطول في العالم؟', options: ['الأمازون', 'النيل', 'اليانغتسي', 'الميسيسيبي'], correct: 'النيل' },
                            { question: 'ما هي أصغر دولة في العالم؟', options: ['موناكو', 'سان مارينو', 'الفاتيكان', 'ليختنشتاين'], correct: 'الفاتيكان' },
                            { question: 'في أي قارة تقع صحراء كالاهاري؟', options: ['آسيا', 'أفريقيا', 'أستراليا', 'أمريكا الجنوبية'], correct: 'أفريقيا' },
                            { question: 'ما هي أعلى قمة جبلية في العالم؟', options: ['قمة إيفرست', 'قمة كي 2', 'قمة كانشينجونغا', 'قمة لوتسي'], correct: 'قمة إيفرست' }
                        ],
                        hard: [
                            { question: 'ما هي عاصمة كازاخستان؟', options: ['ألماتي', 'أستانا', 'شيمكنت', 'أكتوبي'], correct: 'أستانا' },
                            { question: 'كم عدد الجزر في الفلبين تقريباً؟', options: ['5000', '6000', '7000', '8000'], correct: '7000' },
                            { question: 'ما هي أعمق نقطة في المحيطات؟', options: ['خندق ماريانا', 'خندق بورتوريكو', 'خندق اليابان', 'خندق بيرو'], correct: 'خندق ماريانا' }
                        ]
                    }
                },
                mathematics: {
                    name: 'الرياضيات',
                    icon: '📐',
                    color: '#9b59b6',
                    questions: {
                        easy: [
                            { question: 'ما هو ناتج 7 × 8؟', options: ['54', '56', '58', '60'], correct: '56' },
                            { question: 'ما هو الرقم الذي إذا ضرب في نفسه يعطي 64؟', options: ['6', '7', '8', '9'], correct: '8' },
                            { question: 'كم عدد أضلاع المثمن؟', options: ['6', '7', '8', '9'], correct: '8' },
                            { question: 'كم زاوية في المثلث؟', options: ['2', '3', '4', '5'], correct: '3' },
                            { question: 'ما هو مجموع زوايا المثلث؟', options: ['90°', '180°', '270°', '360°'], correct: '180°' }
                        ],
                        medium: [
                            { question: 'ما هو ناتج 15% من 200؟', options: ['25', '30', '35', '40'], correct: '30' },
                            { question: 'ما هي قيمة π (باي) التقريبية؟', options: ['3.14', '3.15', '3.16', '3.17'], correct: '3.14' },
                            { question: 'ما هو العدد الأولي التالي بعد 7؟', options: ['8', '9', '10', '11'], correct: '11' },
                            { question: 'ما هو ناتج √144؟', options: ['11', '12', '13', '14'], correct: '12' }
                        ],
                        hard: [
                            { question: 'ما هو ناتج log₁₀(1000)؟', options: ['2', '3', '4', '5'], correct: '3' },
                            { question: 'إذا كان sin(30°) = 1/2، فما قيمة cos(60°)؟', options: ['1/2', '√3/2', '√2/2', '1'], correct: '1/2' },
                            { question: 'ما هي صيغة مساحة الدائرة؟', options: ['πr', '2πr', 'πr²', '2πr²'], correct: 'πr²' }
                        ]
                    }
                },
                computer: {
                    name: 'المعلوماتية',
                    icon: '💻',
                    color: '#1abc9c',
                    questions: {
                        easy: [
                            { question: 'ما هو اختصار CPU؟', options: ['معالج مركزي', 'وحدة معالجة مركزية', 'ذاكرة مؤقتة', 'قرص صلب'], correct: 'وحدة معالجة مركزية' },
                            { question: 'كم بايت في الكيلوبايت؟', options: ['1000', '1024', '1012', '1048'], correct: '1024' },
                            { question: 'من مؤسس شركة مايكروسوفت؟', options: ['ستيف جوبز', 'بيل غيتس', 'مارك زوكربيرغ', 'لاري بيج'], correct: 'بيل غيتس' }
                        ],
                        medium: [
                            { question: 'ما هي لغة البرمجة الأكثر استخداماً في تطوير المواقع؟', options: ['Python', 'Java', 'JavaScript', 'C++'], correct: 'JavaScript' },
                            { question: 'ما هو اختصار HTML؟', options: ['Hyper Text Markup Language', 'High Tech Modern Language', 'Home Tool Markup Language', 'Hyper Transfer Markup Language'], correct: 'Hyper Text Markup Language' }
                        ],
                        hard: [
                            { question: 'ما هو اختصار OSI في طبقات الشبكة؟', options: ['Open Systems Interconnection', 'Operating Systems Interface', 'Open Software Integration', 'Operating Software Interface'], correct: 'Open Systems Interconnection' }
                        ]
                    }
                },
                religion: {
                    name: 'الدين',
                    icon: '☪️',
                    color: '#16a085',
                    questions: {
                        easy: [
                            { question: 'كم عدد أركان الإسلام؟', options: ['4', '5', '6', '7'], correct: '5' },
                            { question: 'كم عدد سور القرآن الكريم؟', options: ['112', '113', '114', '115'], correct: '114' },
                            { question: 'ما هي أول سورة في القرآن الكريم؟', options: ['البقرة', 'الفاتحة', 'آل عمران', 'النساء'], correct: 'الفاتحة' },
                            { question: 'في أي شهر يصوم المسلمون؟', options: ['شعبان', 'رمضان', 'ذو القعدة', 'محرم'], correct: 'رمضان' },
                            { question: 'كم عدد الصلوات المفروضة في اليوم؟', options: ['3', '4', '5', '6'], correct: '5' },
                            { question: 'ما هي القبلة الأولى للمسلمين؟', options: ['الكعبة', 'المسجد الأقصى', 'المسجد النبوي', 'مسجد قباء'], correct: 'المسجد الأقصى' },
                            { question: 'في أي مدينة ولد الرسول محمد صلى الله عليه وسلم؟', options: ['المدينة', 'مكة', 'الطائف', 'جدة'], correct: 'مكة' },
                            { question: 'كم عدد أركان الإيمان؟', options: ['5', '6', '7', '8'], correct: '6' }
                        ],
                        medium: [
                            { question: 'كم استغرقت فترة نزول القرآن الكريم؟', options: ['20 سنة', '21 سنة', '22 سنة', '23 سنة'], correct: '23 سنة' },
                            { question: 'ما هي أطول سورة في القرآن الكريم؟', options: ['آل عمران', 'البقرة', 'النساء', 'المائدة'], correct: 'البقرة' },
                            { question: 'في أي عام وقعت غزوة بدر؟', options: ['1 هـ', '2 هـ', '3 هـ', '4 هـ'], correct: '2 هـ' },
                            { question: 'من هو أول من أسلم من الرجال؟', options: ['عمر بن الخطاب', 'أبو بكر الصديق', 'علي بن أبي طالب', 'عثمان بن عفان'], correct: 'أبو بكر الصديق' },
                            { question: 'كم عدد أسماء الله الحسنى؟', options: ['97', '98', '99', '100'], correct: '99' },
                            { question: 'في أي عام فتحت مكة؟', options: ['6 هـ', '7 هـ', '8 هـ', '9 هـ'], correct: '8 هـ' }
                        ],
                        hard: [
                            { question: 'من هو أول من جمع القرآن الكريم في مصحف واحد؟', options: ['أبو بكر الصديق', 'عمر بن الخطاب', 'عثمان بن عفان', 'علي بن أبي طالب'], correct: 'أبو بكر الصديق' },
                            { question: 'كم عدد آيات سورة البقرة؟', options: ['284', '285', '286', '287'], correct: '286' },
                            { question: 'في أي سورة ذكرت قصة أصحاب الكهف؟', options: ['الإسراء', 'الكهف', 'مريم', 'طه'], correct: 'الكهف' },
                            { question: 'من هو الصحابي الملقب بـ "أبو تراب"؟', options: ['أبو بكر الصديق', 'عمر بن الخطاب', 'عثمان بن عفان', 'علي بن أبي طالب'], correct: 'علي بن أبي طالب' },
                            { question: 'كم عدد السجدات في القرآن الكريم؟', options: ['13', '14', '15', '16'], correct: '15' }
                        ]
                    }
                },
                philosophy: {
                    name: 'الفلسفة',
                    icon: '🤔',
                    color: '#8e44ad',
                    questions: {
                        easy: [
                            { question: 'من هو الفيلسوف اليوناني الذي علم الإسكندر الأكبر؟', options: ['سقراط', 'أفلاطون', 'أرسطو', 'ديموقريطس'], correct: 'أرسطو' },
                            { question: 'من قال "أعرف أنني لا أعرف شيئاً"؟', options: ['أفلاطون', 'سقراط', 'أرسطو', 'هيراقليطس'], correct: 'سقراط' },
                            { question: 'ما هو الفرع الفلسفي الذي يدرس الأخلاق؟', options: ['المنطق', 'الأخلاق', 'الميتافيزيقا', 'المعرفة'], correct: 'الأخلاق' },
                            { question: 'من هو مؤسس الأكاديمية في أثينا؟', options: ['سقراط', 'أفلاطون', 'أرسطو', 'زينون'], correct: 'أفلاطون' },
                            { question: 'أي فيلسوف كتب "الجمهورية"؟', options: ['سقراط', 'أفلاطون', 'أرسطو', 'أبيقور'], correct: 'أفلاطون' },
                            { question: 'ما هي المدرسة الفلسفية التي تؤمن بأن المتعة هي الخير الأعظم؟', options: ['الرواقية', 'الأبيقورية', 'الشكية', 'الكلبية'], correct: 'الأبيقورية' }
                        ],
                        medium: [
                            { question: 'من هو الفيلسوف الذي قال "أفكر إذن أنا موجود"؟', options: ['ديكارت', 'سبينوزا', 'ليبنتز', 'كانط'], correct: 'ديكارت' },
                            { question: 'أي فيلسوف كتب "نقد العقل المحض"؟', options: ['هيجل', 'كانط', 'شوبنهاور', 'نيتشه'], correct: 'كانط' },
                            { question: 'من هو مؤسس المذهب الوجودي؟', options: ['سارتر', 'كيركجارد', 'كامو', 'هايدجر'], correct: 'كيركجارد' },
                            { question: 'أي فيلسوف عربي كتب "تهافت الفلاسفة"؟', options: ['ابن سينا', 'الفارابي', 'الغزالي', 'ابن رشد'], correct: 'الغزالي' },
                            { question: 'من قال "الجحيم هو الآخرون"؟', options: ['سارتر', 'كامو', 'بوفوار', 'مرلو بونتي'], correct: 'سارتر' }
                        ],
                        hard: [
                            { question: 'أي فيلسوف طور مفهوم "الإنسان الأعلى"؟', options: ['شوبنهاور', 'نيتشه', 'كيركجارد', 'دوستويفسكي'], correct: 'نيتشه' },
                            { question: 'من هو الفيلسوف الذي كتب "الوجود والعدم"؟', options: ['سارتر', 'هايدجر', 'مرلو بونتي', 'كامو'], correct: 'سارتر' },
                            { question: 'أي فيلسوف ابتكر مصطلح "القلق الوجودي"؟', options: ['سارتر', 'كيركجارد', 'هايدجر', 'ياسبرز'], correct: 'كيركجارد' },
                            { question: 'من كتب "رسالة في اللاهوت والسياسة"؟', options: ['ديكارت', 'سبينوزا', 'ليبنتز', 'لوك'], correct: 'سبينوزا' }
                        ]
                    }
                },
                physics: {
                    name: 'الفيزياء',
                    icon: '⚛️',
                    color: '#e74c3c',
                    questions: {
                        easy: [
                            { question: 'ما هي وحدة قياس القوة؟', options: ['جول', 'نيوتن', 'واط', 'أمبير'], correct: 'نيوتن' },
                            { question: 'كم تبلغ سرعة الضوء تقريباً؟', options: ['300,000 كم/ث', '3,000,000 كم/ث', '30,000 كم/ث', '300 كم/ث'], correct: '300,000 كم/ث' },
                            { question: 'ما هي وحدة قياس الطاقة؟', options: ['نيوتن', 'جول', 'واط', 'فولت'], correct: 'جول' },
                            { question: 'من وضع قوانين الحركة الثلاثة؟', options: ['أينشتاين', 'نيوتن', 'جاليليو', 'كبلر'], correct: 'نيوتن' },
                            { question: 'ما هو الرمز الكيميائي للماء؟', options: ['H2O', 'CO2', 'NaCl', 'O2'], correct: 'H2O' },
                            { question: 'ما هي وحدة قياس التيار الكهربائي؟', options: ['فولت', 'أوم', 'أمبير', 'واط'], correct: 'أمبير' }
                        ],
                        medium: [
                            { question: 'ما هو قانون أوهم؟', options: ['V = I × R', 'F = m × a', 'E = m × c²', 'P = F / A'], correct: 'V = I × R' },
                            { question: 'ما هي درجة الحرارة المطلقة للصفر؟', options: ['-273°C', '-100°C', '-200°C', '-373°C'], correct: '-273°C' },
                            { question: 'من اكتشف الجاذبية؟', options: ['أينشتاين', 'نيوتن', 'جاليليو', 'كوبرنيكوس'], correct: 'نيوتن' },
                            { question: 'ما هي معادلة أينشتاين الشهيرة؟', options: ['F = ma', 'E = mc²', 'PV = nRT', 'V = IR'], correct: 'E = mc²' },
                            { question: 'ما هي أصغر وحدة في المادة؟', options: ['الجزيء', 'الذرة', 'البروتون', 'النيوترون'], correct: 'الذرة' }
                        ],
                        hard: [
                            { question: 'ما هو مبدأ عدم اليقين؟', options: ['مبدأ هايزنبرغ', 'مبدأ باولي', 'مبدأ بور', 'مبدأ شرودنجر'], correct: 'مبدأ هايزنبرغ' },
                            { question: 'ما هي نظرية الأوتار؟', options: ['نظرية توحد القوى الأربع', 'نظرية الجاذبية', 'نظرية الكم', 'نظرية النسبية'], correct: 'نظرية توحد القوى الأربع' },
                            { question: 'من اكتشف مبدأ الكوانتا؟', options: ['أينشتاين', 'بلانك', 'بور', 'هايزنبرغ'], correct: 'بلانك' },
                            { question: 'ما هي المعادلة الموجية لشرودنجر؟', options: ['معادلة الحركة الكوانتية', 'معادلة الجاذبية', 'معادلة الضوء', 'معادلة الحرارة'], correct: 'معادلة الحركة الكوانتية' }
                        ]
                    }
                },
                general: {
                    name: 'أسئلة عامة',
                    icon: '🌟',
                    color: '#f1c40f',
                    questions: {
                        easy: [
                            { question: 'كم عدد أيام السنة؟', options: ['364', '365', '366', '367'], correct: '365' },
                            { question: 'ما هو أكبر حيوان في العالم؟', options: ['الفيل', 'الحوت الأزرق', 'الزرافة', 'القرش'], correct: 'الحوت الأزرق' },
                            { question: 'كم عدد القارات في العالم؟', options: ['5', '6', '7', '8'], correct: '7' },
                            { question: 'ما هو أسرع حيوان بري؟', options: ['الأسد', 'النمر', 'الفهد', 'الذئب'], correct: 'الفهد' },
                            { question: 'كم عدد أسنان الإنسان البالغ؟', options: ['28', '30', '32', '34'], correct: '32' },
                            { question: 'ما هو أكبر كوكب في المجموعة الشمسية؟', options: ['زحل', 'المشتري', 'نبتون', 'أورانوس'], correct: 'المشتري' },
                            { question: 'كم عدد العضلات في جسم الإنسان تقريباً؟', options: ['400', '500', '600', '700'], correct: '600' },
                            { question: 'ما هو أطول نهر في العالم؟', options: ['الأمازون', 'النيل', 'اليانغتسي', 'الميسيسيبي'], correct: 'النيل' }
                        ],
                        medium: [
                            { question: 'ما هو أعمق محيط في العالم؟', options: ['الأطلسي', 'الهندي', 'الهادئ', 'المتجمد الشمالي'], correct: 'الهادئ' },
                            { question: 'كم عدد العظام في جسم الإنسان البالغ؟', options: ['200', '206', '210', '215'], correct: '206' },
                            { question: 'ما هي أصغر دولة في العالم من حيث المساحة؟', options: ['موناكو', 'سان مارينو', 'الفاتيكان', 'ليختنشتاين'], correct: 'الفاتيكان' },
                            { question: 'في أي عام انتهت الحرب العالمية الأولى؟', options: ['1917', '1918', '1919', '1920'], correct: '1918' },
                            { question: 'ما هو أكثر عنصر وفرة في الغلاف الجوي؟', options: ['الأكسجين', 'النيتروجين', 'ثاني أكسيد الكربون', 'الأرجون'], correct: 'النيتروجين' },
                            { question: 'كم عدد الألوان في قوس قزح؟', options: ['5', '6', '7', '8'], correct: '7' },
                            { question: 'ما هي العملة الرسمية لليابان؟', options: ['الوان', 'الين', 'الدولار', 'اليورو'], correct: 'الين' },
                            { question: 'كم عدد الدقائق في اليوم الواحد؟', options: ['1440', '1400', '1480', '1500'], correct: '1440' }
                        ],
                        hard: [
                            { question: 'ما هو أندر فصيلة دم؟', options: ['AB-', 'O-', 'Rh-null', 'A-'], correct: 'Rh-null' },
                            { question: 'كم عدد الجزر في فنلندا تقريباً؟', options: ['168,000', '188,000', '208,000', '228,000'], correct: '188,000' },
                            { question: 'ما هو أقدم كائن حي على وجه الأرض؟', options: ['السلاحف', 'أشجار الصنوبر', 'البكتيريا', 'الشعاب المرجانية'], correct: 'البكتيريا' },
                            { question: 'كم يبلغ عمق أعمق نقطة في المحيط؟', options: ['10,994 متر', '11,034 متر', '11,994 متر', '12,034 متر'], correct: '11,034 متر' },
                            { question: 'ما هو أطول جسر معلق في العالم؟', options: ['جسر أكاشي كايكيو', 'جسر جولدن جيت', 'جسر ماكيناك', 'جسر فيرازانو'], correct: 'جسر أكاشي كايكيو' },
                            { question: 'كم عدد اللغات المنطوقة في العالم تقريباً؟', options: ['5000', '6000', '7000', '8000'], correct: '7000' }
                        ]
                    }
                }
            }
        };

        // متغيرات اللعبة
        let currentState = {
            selectedCategory: null,
            selectedDifficulty: null,
            totalQuestions: 0,
            currentQuestion: 0,
            score: 0,
            questionsToPlay: [],
            selectedAnswer: null,
            gamePhase: 'category'
        };

        // الدوال المساعدة
        function showScreen(screenId) {
            document.querySelectorAll('.game-screen').forEach(screen => {
                screen.classList.remove('active');
            });
            document.getElementById(screenId).classList.add('active');
        }

        function getRandomQuestions(category, difficulty, count) {
            const questions = [...gameData.categories[category].questions[difficulty]];
            const selected = [];
            const usedIndices = new Set();
            
            for (let i = 0; i < Math.min(count, questions.length); i++) {
                let randomIndex;
                do {
                    randomIndex = Math.floor(Math.random() * questions.length);
                } while (usedIndices.has(randomIndex));
                
                usedIndices.add(randomIndex);
                selected.push(questions[randomIndex]);
            }
            
            return selected;
        }

        function getAvailableQuestionCounts(categoryKey, difficultyKey) {
            if (!categoryKey || !difficultyKey) return [];
            const maxQuestions = gameData.categories[categoryKey].questions[difficultyKey].length;
            const counts = [];
            
            const options = [3, 5, 10, 15, 20, 25, 30];
            options.forEach(count => {
                if (count <= maxQuestions) {
                    counts.push(count);
                }
            });
            
            if (!counts.includes(maxQuestions)) {
                counts.push(maxQuestions);
            }
            
            return counts.sort((a, b) => a - b);
        }

        function getScoreMessage(percentage) {
            if (percentage === 100) return 'مثالي! 🏆 أداء استثنائي!';
            if (percentage >= 90) return 'ممتاز جداً! 🌟 إنجاز رائع!';
            if (percentage >= 80) return 'ممتاز! 🎯 أداء قوي!';
            if (percentage >= 70) return 'جيد جداً! 👍 عمل طيب!';
            if (percentage >= 60) return 'جيد! 💪 يمكنك التحسن!';
            if (percentage >= 40) return 'لا بأس! 📚 تحتاج مزيد من المراجعة!';
            return 'تحتاج للمزيد من الدراسة! 🔄 لا تستسلم!';
        }

        function getScoreClass(percentage) {
            if (percentage >= 80) return 'excellent';
            if (percentage >= 60) return 'good';
            return 'poor';
        }

        // إنشاء شاشة اختيار المجال
        function createCategoryScreen() {
            const grid = document.getElementById('categoriesGrid');
            grid.innerHTML = '';

            Object.entries(gameData.categories).forEach(([key, category]) => {
                const totalQuestions = Object.values(category.questions).reduce((sum, diff) => sum + diff.length, 0);
                
                const card = document.createElement('div');
                card.className = 'category-card';
                card.style.background = `linear-gradient(135deg, ${category.color}aa, ${category.color}dd)`;
                card.onclick = () => selectCategory(key);

                card.innerHTML = `
                    <span class="category-icon">${category.icon}</span>
                    <h3 class="category-title">${category.name}</h3>
                    <div class="category-stats">
                        <p>المجموع: ${totalQuestions} سؤال</p>
                        <div style="display: flex; justify-content: center; gap: 10px; margin-top: 5px; font-size: 0.8rem;">
                            <span>🟢 ${category.questions.easy.length}</span>
                            <span>🟡 ${category.questions.medium.length}</span>
                            <span>🔴 ${category.questions.hard.length}</span>
                        </div>
                    </div>
                    <div style="display: flex; align-items: center; justify-content: center; gap: 5px;">
                        <span>اختر هذا المجال</span>
                        <span style="transform: scaleX(-1);">➤</span>
                    </div>
                `;
                
                grid.appendChild(card);
            });
        }

        // إنشاء شاشة اختيار الصعوبة
        function createDifficultyScreen() {
            const categoryData = gameData.categories[currentState.selectedCategory];
            
            document.getElementById('selectedCategoryIcon').textContent = categoryData.icon;
            document.getElementById('selectedCategoryName').textContent = categoryData.name;

            const grid = document.getElementById('difficultyGrid');
            grid.innerHTML = '';

            Object.entries(gameData.difficulties).forEach(([key, difficulty]) => {
                const availableQuestions = categoryData.questions[key].length;
                
                const card = document.createElement('div');
                card.className = 'difficulty-card';
                card.style.background = `linear-gradient(135deg, ${difficulty.color}aa, ${difficulty.color}dd)`;
                card.onclick = () => selectDifficulty(key);

                card.innerHTML = `
                    <span class="difficulty-icon">${difficulty.icon}</span>
                    <h3 class="difficulty-title">${difficulty.name}</h3>
                    <p style="font-size: 1.1rem; margin-bottom: 15px;">
                        ${difficulty.multiplier} ${difficulty.multiplier === 1 ? 'نقطة' : difficulty.multiplier === 2 ? 'نقطتان' : 'نقاط'}
                    </p>
                    <p style="font-size: 0.9rem; opacity: 0.9; margin-bottom: 20px;">
                        لكل إجابة صحيحة
                    </p>
                    <div style="background: rgba(255,255,255,0.2); padding: 10px; border-radius: 8px;">
                        <div style="font-size: 0.8rem;">الأسئلة المتوفرة</div>
                        <div style="font-size: 1.5rem; font-weight: bold;">
                            ${availableQuestions}
                        </div>
                    </div>
                `;
                
                grid.appendChild(card);
            });
        }

        // إنشاء شاشة اختيار عدد الأسئلة
        function createQuestionsScreen() {
            const categoryData = gameData.categories[currentState.selectedCategory];
            const difficultyData = gameData.difficulties[currentState.selectedDifficulty];
            const maxQuestions = categoryData.questions[currentState.selectedDifficulty].length;
            
            document.getElementById('questionsCategoryIcon').textContent = categoryData.icon;
            document.getElementById('questionsDifficultyIcon').textContent = difficultyData.icon;
            document.getElementById('questionsCategoryName').textContent = categoryData.name;
            document.getElementById('questionsDifficultyName').textContent = difficultyData.name;
            document.getElementById('maxQuestionsAvailable').textContent = maxQuestions;
            document.getElementById('pointsPerQuestion').textContent = 
                `${difficultyData.multiplier} ${difficultyData.multiplier === 1 ? 'نقطة' : difficultyData.multiplier === 2 ? 'نقطتان' : 'نقاط'}`;

            const availableCounts = getAvailableQuestionCounts(currentState.selectedCategory, currentState.selectedDifficulty);
            const grid = document.getElementById('countGrid');
            grid.innerHTML = '';

            availableCounts.forEach(count => {
                const maxScore = count * difficultyData.multiplier;
                const isMax = count === maxQuestions;
                
                const card = document.createElement('div');
                card.className = `count-card ${isMax ? 'count-max' : ''}`;
                card.onclick = () => startGame(count);

                card.innerHTML = `
                    ${isMax ? '<div style="color: #f1c40f; margin-bottom: 10px;">⭐</div>' : ''}
                    <div class="count-number">${count}</div>
                    <div style="font-size: 0.9rem; opacity: 0.9; margin-bottom: 15px;">
                        ${count === 1 ? 'سؤال واحد' : count <= 10 ? `${count} أسئلة` : `${count} سؤال`}
                    </div>
                    <div style="background: rgba(255,255,255,0.2); padding: 8px; border-radius: 6px;">
                        <div style="font-size: 0.7rem; opacity: 0.8;">الحد الأقصى</div>
                        <div style="font-size: 1.2rem; font-weight: bold;">${maxScore}</div>
                    </div>
                    ${isMax ? '<div style="font-size: 0.7rem; color: #f1c40f; margin-top: 8px;">جميع الأسئلة المتوفرة</div>' : ''}
                `;
                
                grid.appendChild(card);
            });
        }

        // إنشاء شاشة اللعب
        function createGameScreen() {
            const categoryData = gameData.categories[currentState.selectedCategory];
            const difficultyData = gameData.difficulties[currentState.selectedDifficulty];
            
            document.getElementById('gameCategoryIcon').textContent = categoryData.icon;
            document.getElementById('gameCategoryName').textContent = categoryData.name;
            
            updateGameProgress();
            updateQuestion();
        }

        function updateGameProgress() {
            const difficultyData = gameData.difficulties[currentState.selectedDifficulty];
            document.getElementById('gameProgress').textContent = 
                `السؤال ${currentState.currentQuestion + 1} من ${currentState.totalQuestions} - مستوى ${difficultyData.name}`;
            
            const progress = ((currentState.currentQuestion + 1) / currentState.totalQuestions) * 100;
            document.getElementById('progressFill').style.width = `${progress}%`;
            
            document.getElementById('currentScore').textContent = currentState.score;
        }

        function updateQuestion() {
            const question = currentState.questionsToPlay[currentState.currentQuestion];
            document.getElementById('questionText').textContent = question.question;
            
            const optionsGrid = document.getElementById('optionsGrid');
            optionsGrid.innerHTML = '';
            
            question.options.forEach((option, index) => {
                const btn = document.createElement('button');
                btn.className = 'option-btn';
                btn.onclick = () => handleAnswer(option);
                btn.innerHTML = `<span>${option}</span>`;
                optionsGrid.appendChild(btn);
            });
            
            document.getElementById('feedback').textContent = '';
        }

        function handleAnswer(selectedOption) {
            if (currentState.selectedAnswer) return;
            
            currentState.selectedAnswer = selectedOption;
            const question = currentState.questionsToPlay[currentState.currentQuestion];
            const isCorrect = selectedOption === question.correct;
            
            // تحديث الأزرار
            const buttons = document.querySelectorAll('.option-btn');
            buttons.forEach(btn => {
                const option = btn.querySelector('span').textContent;
                btn.disabled = true;
                
                if (option === question.correct) {
                    btn.classList.add('option-correct');
                    btn.innerHTML += '<span>✓</span>';
                } else if (option === selectedOption && !isCorrect) {
                    btn.classList.add('option-wrong');
                    btn.innerHTML += '<span>✗</span>';
                } else {
                    btn.classList.add('option-disabled');
                }
            });
            
            // عرض التغذية الراجعة
            const feedback = document.getElementById('feedback');
            const difficultyData = gameData.difficulties[currentState.selectedDifficulty];
            
            if (isCorrect) {
                currentState.score += difficultyData.multiplier;
                feedback.textContent = `ممتاز! +${difficultyData.multiplier} نقطة`;
                feedback.className = 'feedback correct';
            } else {
                feedback.textContent = 'إجابة خاطئة، حظ أوفر في السؤال التالي';
                feedback.className = 'feedback wrong';
            }
            
            document.getElementById('currentScore').textContent = currentState.score;
            
            // الانتقال للسؤال التالي
            setTimeout(() => {
                if (currentState.currentQuestion + 1 < currentState.totalQuestions) {
                    currentState.currentQuestion++;
                    currentState.selectedAnswer = null;
                    updateGameProgress();
                    updateQuestion();
                } else {
                    showResults();
                }
            }, 2000);
        }

        function showResults() {
            const categoryData = gameData.categories[currentState.selectedCategory];
            const difficultyData = gameData.difficulties[currentState.selectedDifficulty];
            const maxPossibleScore = currentState.totalQuestions * difficultyData.multiplier;
            const percentage = Math.round((currentState.score / maxPossibleScore) * 100);
            const correctAnswers = currentState.score / difficultyData.multiplier;
            
            document.getElementById('resultCategoryIcon').textContent = categoryData.icon;
            document.getElementById('resultCategoryName').textContent = categoryData.name;
            document.getElementById('resultDifficultyIcon').textContent = difficultyData.icon;
            document.getElementById('resultDifficultyName').textContent = `مستوى ${difficultyData.name}`;
            
            const finalScoreEl = document.getElementById('finalScore');
            finalScoreEl.textContent = `${currentState.score}/${maxPossibleScore}`;
            finalScoreEl.className = `final-score ${getScoreClass(percentage)}`;
            
            document.getElementById('percentage').textContent = percentage;
            document.getElementById('resultMessage').textContent = getScoreMessage(percentage);
            document.getElementById('totalQuestions').textContent = currentState.totalQuestions;
            document.getElementById('correctAnswers').textContent = correctAnswers;
            
            showScreen('resultScreen');
        }

        // دوال الانتقال
        function selectCategory(categoryKey) {
            currentState.selectedCategory = categoryKey;
            currentState.gamePhase = 'difficulty';
            createDifficultyScreen();
            showScreen('difficultyScreen');
        }

        function selectDifficulty(difficultyKey) {
            currentState.selectedDifficulty = difficultyKey;
            currentState.gamePhase = 'questions';
            createQuestionsScreen();
            showScreen('questionsScreen');
        }

        function startGame(questionCount) {
            currentState.totalQuestions = questionCount;
            currentState.questionsToPlay = getRandomQuestions(
                currentState.selectedCategory, 
                currentState.selectedDifficulty, 
                questionCount
            );
            currentState.currentQuestion = 0;
            currentState.score = 0;
            currentState.selectedAnswer = null;
            currentState.gamePhase = 'playing';
            
            createGameScreen();
            showScreen('gameScreen');
        }

        function goBack() {
            if (currentState.gamePhase === 'difficulty') {
                currentState.selectedCategory = null;
                currentState.gamePhase = 'category';
                showScreen('categoryScreen');
            } else if (currentState.gamePhase === 'questions') {
                currentState.selectedDifficulty = null;
                currentState.gamePhase = 'difficulty';
                createDifficultyScreen();
                showScreen('difficultyScreen');
            } else if (currentState.gamePhase === 'playing') {
                currentState.gamePhase = 'questions';
                createQuestionsScreen();
                showScreen('questionsScreen');
            }
        }

        function resetGame() {
            currentState = {
                selectedCategory: null,
                selectedDifficulty: null,
                totalQuestions: 0,
                currentQuestion: 0,
                score: 0,
                questionsToPlay: [],
                selectedAnswer: null,
                gamePhase: 'category'
            };
            showScreen('categoryScreen');
        }

        function playAgain() {
            startGame(currentState.totalQuestions);
        }

        function changeQuestionCount() {
            currentState.gamePhase = 'questions';
            createQuestionsScreen();
            showScreen('questionsScreen');
        }

        function changeDifficulty() {
            currentState.selectedDifficulty = null;
            currentState.gamePhase = 'difficulty';
            createDifficultyScreen();
            showScreen('difficultyScreen');
        }

        // تهيئة اللعبة
        document.addEventListener('DOMContentLoaded', function() {
            createCategoryScreen();
        });
    </script>
</body>
</html>
